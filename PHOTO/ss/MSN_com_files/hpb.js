(function(){var l=this,c=Msn.DOM,e=Msn.HP.Settings,g=document;l.AddContent=function(x,w,t,u,v,r){var n=d(x);if(n&&Msn.Ajax.Enabled()&&r.length>0){var h,o=a("div"),l=a("form"),s=a("ul"),j,g,p,k,q,m;n.className=u;b(n,a("h2",w));o.className="child c1 first";b(n,o);l.action="#";b(o,l);if(t)b(l,a("p",t));s.className=v;b(l,s);for(h=0;h<r.length;++h){j=a("li");b(s,j);if(h==0)j.className="first";g=r[h];if(g.id){p="cb_"+g.id;k=a("input");k.type="checkbox";k.id=p;k.value=h;b(j,k);q=a("label",g.name);q.htmlFor=p;b(j,q);m=e.GetModuleData(g.code);k.checked=m.V?true:false;g.pos=h%2+1+","+(Math.floor(h/2)+1);i(k,g);if(m.V)f(g,m.E)}}if(j&&c.PrevElem(j,"LI"))j.className="last"}};function i(b,a){(function(h){h=c.Event(h);var j=c.Target(h),i=j.checked,g=e.GetModuleData(a.code),b=d(a.id);if(i)if(b)b.style.display="block";else f(a,g.E);else if(b)b.style.display="none";g.V=i?1:0;e.SetModuleData(a.code,g)}).hook(b,"click");b=0}function f(b,i){var g=h(b.bind);if(g){var e=b.pos.split(","),f=d("area"+e[0]);if(f){var a=j(b,e[1],i);if(a){f.insertBefore(a,k(f,e));Msn.HP.ExpandCollapse.bind(a,b.code);g.bind(a,b);if(c.HasClass(a,"closed"))c.Updated()}}}}function k(e,f){var d=null;for(var c=0;c<e.childNodes.length;++c){var b=e.childNodes[c];if(b.nodeType==1){var a=b.getAttribute("priority");a=a?parseInt(a):0;if(a>f[1]){d=b;break}}}return d}function a(c,a){var b=g.createElement(c);if(a)b.innerHTML=a;return b}function b(a,b){a.appendChild(b)}function j(c,h,g){var d=a("div");d.className="parent "+(c.chrome?c.chrome:"chrome5")+(g?"":" closed");d.id=c.id;d.setAttribute("priority",h);var e,f=a("h2");if(c.href){e=a("a");e.href=c.href;e.innerHTML=c.name;b(f,e)}else f.innerHTML=c.name;b(d,f);return d}function h(d){var a=null,b=d?d.split("."):[];if(b.length>0){a=window;for(var c=0;a&&c<b.length;++c)a=a[b[c]]}return a}function d(a){return g.getElementById(a)}}).ns("Msn.HP.Module");(function(a,g){if(!g)g={};var p=n(g.gtl,"linklist16"),l="Hide",m="Disambiguator Selection",j=this,k=window,s=document,i=Msn.DOM,h,b,c,f=typeof g.close!="undefined"?g.close:l;if(typeof f!="string")f=f?l:0;j.dispose=function(){if(c){k.clearTimeout(c);c=0}a=h=b=0};function r(){if(c)a.style.display="block"}j.msg=function(d,f,e){if(c){k.clearTimeout(c);c=0}if(d){h.innerHTML=d;if(e){a.style.display="none";c=k.setTimeout(r,e)}else a.style.display="block";if(f)a.className="ambi "+f}else a.style.display="none";Msn.Bind.Unbind(b,1);b.innerHTML="";b.style.display="none"};j.add=function(g,c){b.style.display="block";var f=d("li");e(b,f);var a=d("a");a.href=c?c:"#";a.innerHTML=g;if(m)a.setAttribute("piitxt",m);e(f,a);return a};function q(){i.AddClass(a,"ambi");a.style.display="none";if(f){var c=d("a");c.className="del";c.href="#";c.setAttribute("notrack",1);e(a,c);var g=d("div");e(c,g);g.style.visibility="visible";c.title=f;o.hook(c,"click");c=0}h=d("p");e(a,h);b=d("ul");b.className=p;b.style.display="none";e(a,b)}function o(b){b=i.Event(b);a.style.display="none";return i.CancelEvent(b)}function e(a,b){a.appendChild(b)}function d(a){return s.createElement(a)}function n(a,b){return typeof a!="undefined"?a:b}q()}).as("Msn.HP.DA");(function(){var n=this,q=document,k=Msn.HP.Settings,b=Msn.DOM,c=b.ChildElem,j=b.PrevElem,l=b.ParentElem,i=b.AddClass,h=b.DelClass,p=b.Event,o=b.CancelEvent;n.Data=function(B,r){if(!r)r={};var fb=g(r.load,"Loading..."),M=g(r.err,"Feed is temporarily unavailable."),jb=g(r.timeout,5000),Y=g(r.gtl,"linklist16"),eb=g(r.plus,"Show more headlines"),bb=g(r.minus,"Show fewer headlines"),z=g(r.cutoff,5),Z=g(r.delay,2000),kb=this,A,w,R,Q,u,x,t,s,n,X=0,C=0,G="block",y="none",P="hidden",O="visible",J='<img src="{0}" alt="{1}"/>',S='<img src="{0}" alt="{1}" width="{2}" height="{3}"/>',D=r.code?r.code:"",N=r.url?r.url:"",v=r.max?parseInt(r.max):0,V=r.def?parseInt(r.def):0,lb=D&&(typeof r.pm=="undefined"||r.pm)?1:0,K=typeof r.first!="undefined"?r.first:1,ib=r.opennew?1:0,H=r.chan?r.chan:0,I=r.disp?r.disp:0,L;if(r.allhot)L=r.defhref||r.href;function F(b){var a=s.firstChild;while(a&&b--){while(a&&(a.nodeType!=1||a.nodeName!="LI"))a=a.nextSibling;if(b)a=a.nextSibling}return a}function U(g,e){var b=q.createTextNode(g);if(e){var a=d("a");a.href=e;if(ib){var c=Msn.HP.OpenNew;if(c)c.bind(a);else a.target="_blank"}b=f(a,b)}return b}function gb(B){var g,A,o,r=c(B,"rss",1),q=r&&c(r,"channel",1);if(r&&q){var m=0,k;b.ForEach(function(i){var l=a(i,"title");if(l){if(++m>C){var g=a(i,"link"),k=!g||g=="#",c=U(l,k?L:g),b=d("li");if(k){b.className="nb";c=f(d("strong"),c)}f(b,c);f(s,b);if(!j(b))b.className="first"}else{b=F(m);h(b,"last")}if(n>0&&m>n)e(b,y);if(v>0&&m==v)return 1}},q,"item");if(k&&j(k))k.className="last";v=m;if(!n)n=m;if(n>v)n=v;E();if(v>=z&&!t){t=hb(q);if(t){var p=j(s,"DIV");while(p){if(b.HasClass(p,"linkedimg"))l(p).removeChild(p);p=j(s,"DIV")}u.insertBefore(t,s);if(n<z)e(t,y)}}if(K&&(n<z||!t)){k=c(s,"LI");if(k)h(k,"first")}else if(n>=z&&t){k=c(s,"LI");if(k)i(k,"first")}if(I){g=a(r,"msn:displayname",1);if(typeof I=="string")g=g&&I.format(g);if(g){o=d("h4");o.innerHTML=g;u.insertBefore(o,s)}}if(H){g=a(q,"title",1);A=a(q,"link",1);if(typeof H=="string")g=g&&H.format(g);if(g){o=d("h4");f(o,U(g,A));u.insertBefore(o,s)}}if(u)e(u,G);if(x)e(x,G);X=1}else w.msg(M,"err")}function hb(m){var k,g,h,e,j,i,f,b=c(m,"msn:image");if(b){h=a(b,"msn:url");e=a(b,"msn:title");g=a(b,"msn:link");j=a(b,"msn:width");i=a(b,"msn:height");if(j&&i)f=S.format(h,e,j,i);else f=J.format(h,e)}else{b=c(m,"m:image");if(b){h=a(b,"m:url");e=a(b,"m:title");g=a(b,"m:link");j=a(b,"m:width");i=a(b,"m:height");if(j&&i)f=S.format(h,e,j,i);else f=J.format(h,e)}else{b=c(m,"enclosure");if(b){h=b.getAttribute("url");var n=l(b);e=a(n,"description");if(!e||e.indexOf("\u00A9")==-1)e=a(n,"title");g=a(n,"link");f=J.format(h,e)}}}if(f){k=d("div");if(!g||g=="#")g=L;if(g){k.className="linkedimg";k.innerHTML=f.wrap(('<a href="{0}">').format(g))}else k.innerHTML=f}return k}function E(){m(Q,n>1?O:P);m(R,n<v?O:P)}function ab(a){a=p(a);if(n>1){e(F(n--),y);if(n==z-1&&t){e(t,y);if(K)h(c(s,"LI"),"first")}k.SetServerSetting(D,n)}E();return o(a)}function db(a){a=p(a);if(n<v){var b=F(++n);if(b){e(b,G);if(n==z&&t){e(t,G);i(c(s,"LI"),"first")}}else W();k.SetServerSetting(D,n)}E();return o(a)}function T(b,f,e,c){var a=d("a");a.href="#";a.title=f;a.className=b;a.setAttribute("notrack",1);m(a,c?O:P);e.hook(a,"click");return a}function cb(){var a=0,g=1;s=c(B,"UL");if(s){n=k.GetServerSetting(D);if(!n)n=V;C=b.ChildCount(s,"LI");if(!n&&C)n=C;u=l(s,"DIV");b.ForEach(function(a){if(c(a,"IMG"))return t=a},u,"DIV");if(v<n)v=n;if(n&&n<C){b.ForEach(function(a){if(g==n)i(a,"last");else if(g>n){e(a,y);h(a,"last")}++g},s,"LI");if(t&&n<z){e(t,y);if(K)h(c(s,"LI"),"first")}}}else{u=d("div");u.className="imglistset1 cf";f(B,u);e(u,y);s=d("ul");s.className=Y;f(u,s);n=k.GetServerSetting(D);if(!n)n=V;a=1}if(lb){x=d("div");x.className="pm";f(x,R=T("plus",eb,db,n<v));f(x,Q=T("minus",bb,ab,n>1));B.insertBefore(x,B.firstChild);if(a)e(x,y);}var j=d("div");f(B,j);w=new Msn.HP.DA(j);if(a)W()}function W(){if(!X&&N){w.msg(fb,"msg",Z);if(A)A.cancel();A=(function(a){w.msg();if(a.responseXML)gb(a.responseXML);else w.msg(M,"err");if(!F(n))n=b.ChildCount(s,"LI");E()}).RQ(N,jb)}else if(!N)w.msg(M,"err")}kb.dispose=function(){if(A)A.cancel();if(w)w.dispose();B=A=w=R=Q=u=t=s=x=0};cb()};n.Module=function(c,j){var e=this,a,g=0;e.dispose=function(){c=a=0};e.OnExpand=function(){if(!g){n.Data.bind(a,j);g=1}};function h(){i(c,"single1 cf");a=d("div");a.className="child c1 first";f(c,a);if(!b.HasClass(c,"closed"))e.OnExpand()}h()};function d(a){return q.createElement(a)}function f(a,b){a.appendChild(b);return a}function a(e,a,d){return b.InnerText(c(e,a,d))}function e(a,b){if(a)a.style.display=b}function m(a,b){if(a)a.style.visibility=b}function g(a,b){return typeof a!="undefined"?a:b}}).ns("Msn.HP.Rss");(function(b,e){if(!e)e={};var i=h(e.exp,"Expand module"),g=h(e.col,"Collapse module"),l=this,m=document,c=Msn.DOM,k=Msn.HP.Settings,d=!c.HasClass(b,"closed"),j=e,a,f=c.ChildElem(b,"H2",1);if(f){a=m.createElement("a");a.href="#";a.className="ocb";a.setAttribute("notrack",1);a.title=d?g:i;(function(f){f=c.Event(f);if(d){c.AddClass(b,"closed");a.title=i}else{c.DelClass(b,"closed");a.title=g;for(var e=0;e<b.bindings.length;++e){var l=b.bindings[e];if(typeof l.OnExpand=="function")l.OnExpand()}}d=!d;var h=k.GetModuleData(j);h.E=d?1:0;k.SetModuleData(j,h);return c.CancelEvent(f)}).hook(a,"click");f.insertBefore(a,f.firstChild)}function h(a,b){return typeof a!="undefined"?a:b}l.dispose=function(){b=f=a=0}}).as("Msn.HP.ExpandCollapse");(function(a){var b=a.value;this.dispose=function(){a=null};if(b){(function(){if(a.value==b)a.value=""}).hook(a,"focus");(function(){if(!a.value)a.value=b}).hook(a,"blur")}}).as("Msn.HP.TextBoxHint");(function(){var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],k=["January","February","March","April","May","June","July","August","September","October","November","December"],l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["AM","PM"];function h(b,c){if(!b)b=12;if(b>12)b-=12;return c?a(b):b}function a(b,a){a=a?a:2;var d="",e=Math.pow(10,a-1);while(--a&&b<e){d+="0";e/=10}return d+c(b)}function f(b,f){var d=b<0?"-":"+";b*=b<0?-1:1;var e=c(b/60);if(!f)d+=e;else{d+=a(e);if(f>1)d+=":"+a(b%60)}return d}var g={d:[function(a){return a.getDate()},function(b){return a(b.getDate())},function(a){return l[a.getDay()]},function(a){return m[a.getDay()]}],f:[function(b){return a(e(b)/100,1)},function(b){return a(e(b)/10,2)},function(b){return a(e(b),3)}],h:[function(a){return h(b(a))},function(a){return h(b(a),1)}],H:[function(a){return b(a)},function(c){return a(b(c))}],m:[function(a){return a.getMinutes()},function(b){return a(b.getMinutes())}],M:[function(a){return a.getMonth()+1},function(b){return a(b.getMonth()+1)},function(a){return j[a.getMonth()]},function(a){return k[a.getMonth()]}],s:[function(a){return a.getSeconds()},function(b){return a(b.getSeconds())}],t:[function(a){return i[c(b(a)/12)].charAt(0)},function(a){return i[c(b(a)/12)]}],y:[function(a){return a.getYear()},function(b){return a(b.getYear())},function(a){return a.getFullYear()},function(a){return a.getFullYear()}],z:[function(a){return f(d(a))},function(a){return f(d(a),1)},function(a){return f(d(a),2)}]};function d(a){return a.getTimezoneOffset()}function e(a){return a.getMilliseconds()}function b(a){return a.getHours()}function c(a){return Math.floor(a)}Date.addMethod("format",function(d){var c,f,h,e=[],b="",a=0;for(;a<d.length;++a){c=d.charAt(a);if(c=="\\"){if(++a<d.length)b+=d.charAt(a)}else if(g[c]){if(b){e.push(b);b=""}f=g[c];h=a;while(d.charAt(a+1)==c)++a;e.push(f[Math.min(a-h,f.length-1)](this,a-h+1))}else b+=c}if(b)e.push(b);return e.join("")})}).ns("Msn.DateFormatting");(function(l,a){if(!a)a={};var C=f(a.go,"Go"),y=f(a.load,"Loading..."),p=f(a.err,"Horoscope data is temporarily unavailable."),B=f(a.timeout,5000),u=f(a.delay,2000),D=f(a.durl,"ajax/horoscope.aspx?zodiacsign={0}"),s=f(a.hint,"Select a sign"),r=[{code:"ari",text:"Aries (March 20 - April 18)"},{code:"tau",text:"Taurus (April 19 - May 19)"},{code:"gem",text:"Gemini (May 20 - June 20)"},{code:"can",text:"Cancer (June 21 - July 21)"},{code:"leo",text:"Leo (July 22 - August 22)"},{code:"vir",text:"Virgo (August 23 - September 21)"},{code:"lib",text:"Libra (September 22 - October 22)"},{code:"sco",text:"Scorpio (October 23 - November 21)"},{code:"sag",text:"Sagittarius (November 22 - December 20)"},{code:"cap",text:"Capricorn (December 21 - January 19)"},{code:"aqu",text:"Aquarius (January 20 - February 17)"},{code:"pis",text:"Pisces (February 18 - March 19)"}],x=f(a.dd,"ari"),t=this,E=document,h=Msn.DOM,m=h.InnerText,e=h.ChildElem,q=Msn.HP.Settings,k,j,n,d,g,i;t.dispose=function(){if(d)d.dispose();if(k)k.cancel();l=j=n=g=i=d=k=0};t.OnExpand=function(){o()};function o(){if(k){k.cancel();k=null}var a=g.value;if(a){var b=document.getElementById("hor_"+a);if(b){if(j!=b){j.style.display="none";b.style.display="block";j=b}}else{d.msg(y,"msg",u);k=(function(b){d.msg();if(b.responseXML)z(a,b.responseXML);else d.msg(p,"err")}).RQ(D.format(a),B)}}}function z(o,g){var f=e(g,"rss");if(f){var c=e(f,"item");if(c){var l=m(e(c,"title")),k=m(e(c,"description")),i=m(e(c,"msn:daterange"));if(j)j.style.display="none";var a=document.createElement("div");a.id="hor_"+o;a.innerHTML=("<h4>{0} ({1})</h4><p>{2}</p>").format(l,i,k);b(n,a);j=a;var h=e(g,"ad");if(h)A(h)}else d.msg(p,"err")}else d.msg(p,"err")}function A(f){var d=e(f,"item");if(d){if(!i){h.DelClass(l,"single1");h.AddClass(l,"double2");i=c("div");i.className="child c2 last";b(l,i)}else i.innerHTML="";var a=c("a");a.href=m(e(d,"link"));a.innerHTML=m(e(d,"title"));b(i,a)}}function w(){var m=q.GetModuleData(a.code),t=m&&m.D?m.D:x;h.AddClass(l,"single1");var i=c("div");i.className="child c1 first";b(l,i);n=c("div");b(i,n);var p=c("div");b(i,p);d=new Msn.HP.DA(p);var f=c("form");f.action="#";v.hook(f,"submit");b(i,f);Msn.Tracking.Form.bind(f);g=c("select");if(s)g.title=s;b(f,g);var e;for(var k=0;k<r.length;++k){e=c("option");e.value=r[k].code;if(e.value==t)e.selected=true;e.innerHTML=r[k].text;b(g,e)}var j=c("input");j.type="submit";j.className="button";j.value=C;b(f,j);if(!h.HasClass(l,"closed"))o()}function v(c){c=h.Event(c);var b=q.GetModuleData(a.code);if(!b||g.value!=b.D){o();b.D=g.value;q.SetModuleData(a.code,b)}return h.CancelEvent(c)}function c(a){return E.createElement(a)}function b(a,b){a.appendChild(b)}function f(a,b){return typeof a!="undefined"?a:b}w()}).as("Msn.HP.Horoscope");(function(j,a){if(!a)a={};var J=b(a.timeout,5000),G=b(a.len,100),K=b(a.go,"Go"),l=b(a.hint,"Get guides by city or ZIP code"),F=b(a.max,15),w=b(a.delay,2000),H=b(a.surl,"ajax/cityGuidesSearch.aspx?ldlocation={0}"),I=b(a.durl,"ajax/cityGuidesData.aspx?providerid={0}"),B=b(a.load,"Loading..."),E=b(a.choose,"Possible matches are listed below. Please select a location from the list below or enter a new location in the text box above."),t=b(a.err,"City guide data is temporarily unavailable."),v=b(a.dup,"The City Guide for this location is already being displayed."),z=b(a.dd,"lg:newyorkny"),n=this,L=document,e=Msn.DOM,s=e.Event,p=e.CancelEvent,q=e.ChildElem,k=Msn.HP.Settings,D=Msn.Tracking.Event,g,r,c,d,f;function b(a,b){return typeof a!="undefined"?a:b}n.dispose=function(){if(c)c.dispose();if(g)g.cancel();j=d=c=f=g=0};n.OnExpand=function(){var b=k.GetModuleData(a.code),c=b&&b.D?b.D:z;if(c&&c!=r)m(c)};function C(b){b=s(b);var d=e.Target(b);D(d);var f=k.GetModuleData(a.code);if(f&&f.D==d.href)c.msg(v,"err");else m(d.href);return p(b)}function m(b){var e=k.GetModuleData(a.code);if(e){e.D=b;k.SetModuleData(a.code,e)}r=b;Msn.Bind.Unbind(f,1);f.innerHTML="";a.url=I.format(b);Msn.HP.Rss.Data.bind(f,a);c.msg();d.value=l}function A(a){if(g){g.cancel();g=null}var b=d.value==l?"":d.value;if(b){c.msg(B,"msg",w);g=(function(a){if(a.responseXML)u(a.responseXML);else c.msg(t,"err")}).RQ(H.format(b),J)}else c.msg();a=s(a);return p(a)}function u(g){var d=q(g,"results");if(d){var a=new x;e.ForEach(function(b){e.ForEach(function(b){var c=o(b,"providerid");if(!a.contains(c))a.add(c,o(b,"displayname"))},b,"provider")},d,"location");if(a.length==1)m(a[0].id);else{c.msg(E,"msg");for(var b=0;b<a.length&&b<F;++b){var f=a[b];C.hook(c.add(f.name,f.id),"click")}}}else c.msg(t,"err")}function x(){var a=this,b={};a.length=0;a.contains=function(a){return b[a]==1};a.add=function(c,d){b[c]=1;a[a.length++]={id:c,name:d}}}function h(a){return L.createElement(a)}function i(a,b){a.appendChild(b)}function o(b,a){return e.InnerText(q(b,a))}function y(){e.AddClass(j,"double2 cf");f=h("div");f.className="child c1 first";i(j,f);var g=h("div");g.className="child c2 last";i(j,g);var a=h("form");a.action="#";A.hook(a,"submit");i(g,a);Msn.Tracking.Form.bind(a);d=h("input");d.type="text";d.className="hint";d.maxLength=G;d.value=d.title=l;Msn.HP.TextBoxHint.bind(d);i(a,d);var b=h("input");b.type="submit";b.className="button";b.value=K;i(a,b);var k=h("div");i(a,k);c=new Msn.HP.DA(k);if(!e.HasClass(j,"closed"))n.OnExpand()}y()}).as("Msn.HP.CityGuide");(function(c,b){if(!b)b={};a("timeout",5000);a("len",100);a("go","Go");a("hint","Find news by city or ZIP code");a("max",15);a("delay",2000);a("surl","ajax/localNewsSearch.aspx?ldlocation={0}");a("durl","ajax/localNewsData.aspx?providerid={0}");a("load","Loading...");a("choose","Possible matches are listed below. Please select a location from the list below or enter a new location in the text box above.");a("err","Local news data is temporarily unavailable.");a("dup","The local news for this location is already being displayed.");a("dd","LN:WNBC");function a(a,c){if(typeof b[a]=="undefined")b[a]=c}return new Msn.HP.CityGuide(c,b)}).as("Msn.HP.LocalNews");(function(A,a){if(!a)a={};var Q=b(a.timeout,5000),S=b(a.timeout,","),Ab=b(a.durl,"ajax/weatherdata.aspx?wealocations={0}&weadegreetype={1}"),Bb=b(a.surl,"ajax/weathersearch.aspx?weasearchstr={0}"),J=b(a.delay,2000),M=b(a.load,"Loading..."),lb=b(a.none,"Add weather forecasts by entering the zip code or city below and clicking Go."),vb=b(a.choose,"Possible matches are listed below. Please select a location from the list below or enter a new location in the text box above."),z=b(a.err,"Weather data is temporarily unavailable."),kb=b(a.nores,"Data for this location was not found.  Please enter a new city name or zip in the text box above."),hb=b(a.dup,"The weather for this location is already on your list."),tb=b(a.nomore,'Please delete a weather location before adding a new one. To delete a weather location, hover over the location above you want to delete and click the "X" that appears.'),nb=b(a.max,15),jb=b(a.fore,4),D=b(a.units,"W"),pb=b(a.togf,"\u00B0F"),ob=b(a.togc,"\u00B0C"),ab=b(a.togf,"Change units to Fahrenheit"),Z=b(a.togc,"Change units to Celsius"),cb=b(a.del,"Remove {0}"),eb=b(a.up,"Move up {0}"),V=b(a.dn,"Move down {0}"),bb=b(a.cur,"{0} {1}"),db=b(a.highlow,"{0} / {1}"),fb=b(a.na,"n/a"),sb=b(a.temp,"{0}\u00B0"),zb=this,Cb=document,k=Msn.HP.Settings,O=Msn.Bind,e=Msn.DOM,l=e.Event,u=e.Target,p=e.CancelEvent,g=e.ChildElem,j=e.ParentElem,n=e.PrevElem,m=e.NextElem,y=e.AddClass,mb=e.DelClass,K=e.HasClass,x=e.ChildCount,ub=Msn.Tracking.Event,L,r,q,d,h,o,v,rb=typeof a.fc!="undefined"?a.fc:1,P={F:ab,C:Z},i,F="none",R="block",ib={F:"C",C:"F"};zb.dispose=function(){if(d)d.dispose();if(v){v.cancel();v=null}A=q=d=h=r=o=0};function C(a){if(a&&a.length>0){d.msg(M,"msg",J);v=(function(a){if(a.responseXML)Y(a.responseXML);else d.msg(z,"err")}).RQ(Ab.format(a.join(S),k.GetServerSetting(D)),Q)}}function Y(G){var C=g(G,"weatherdata");if(C){d.msg();q.focus();q.value="";var D=g(h,"P",1);if(D)t(h,D);var p,o,a,r=[];e.ForEach(function(b){a={weatherCode:b.getAttribute("weatherlocationcode"),displayName:b.getAttribute("weatherlocationname"),weatherUrl:b.getAttribute("url"),imageBase:b.getAttribute("imagerelativeurl"),forecasts:[]};r.push(a);e.ForEach(function(b){switch(b.nodeName){case "current":a.current={desc:b.getAttribute("skytext"),temp:b.getAttribute("temperature")};break;case "forecast":a.forecasts.push({day:b.getAttribute("day"),high:b.getAttribute("high"),low:b.getAttribute("low"),code:b.getAttribute("skycodeday"),desc:b.getAttribute("skytextday"),date:Date.parse(b.getAttribute("date"))});break}},b)},C,"weather");var i=g(h,"UL",1);if(!i){i=c("ul");i.className="forecast1";f(h,i)}for(var v=0;v<r.length;++v){a=r[v];var k=null;e.ForEach(function(b){if(w(b,1)==a.displayName)return k=b},i,"LI");var j=c("li");j.className="cf";i.insertBefore(j,k);if(k){O.Unbind(k,1);t(i,k);k=null}else{var A=n(j,"LI");if(A)s(A,"UpdateButtons")}N.bind(j,{code:a.weatherCode,name:a.displayName});o=c("h4");if(a.weatherUrl)o.innerHTML=('<a href="{1}">{0}</a>').format(a.displayName,a.weatherUrl);else o.innerHTML=a.displayName;f(j,o);if(a.current){p=c("span",bb.format(a.current.desc,B(a.current.temp)));f(j,p)}var b,x=c("ul");x.className="cf";for(var m=0;m<4&&m<a.forecasts.length;++m){var l=a.forecasts[m];b=c("li");if(m==1)b.className="first";var H=c("h5",l.day);f(b,H);var u=c("img");u.src=a.imageBase+l.code+".gif";u.alt=l.desc;f(b,u);var E=B(l.high),F=B(l.low);p=c("span",db.format(E,F));f(b,p);f(x,b)}if(b&&!K(b,"first"))y(b,"last");f(j,x)}}else d.msg(z,"err")}function B(a){return a?sb.format(a):fb}function N(a,o){o=o?o:{};var g=this,L=o.name,B=o.code,b=[],h;function N(){var d=c("div");d.className="btnbar";a.insertBefore(d,a.firstChild);b.push(A(d,"up",eb,P,!n(a,"LI")));b.push(A(d,"dn",V,I,!m(a,"LI")));b.push(A(d,"rem",cb,D))}function A(i,e,h,d,g){var a=c("a");a.href="#";a.className=e;a.title=h.format(L);a.setAttribute("notrack",1);d.hook(a,"click");E.hook(a,"focus");H.hook(a,"blur");f(i,a);if(g)y(a,F);var b=c("div");f(a,b);return b}function E(a){a=l(a);h=u(a).childNodes[0];q(h,"visible")}function H(a){a=l(a);if(i!=g)q(h,"hidden");h=0}function J(){if(i!=g)w()}function M(a){a=l(a);if(!K(a.relatedTarget?a.relatedTarget:a.toElement))v()}function w(){for(var a=0;a<b.length;++a)q(b[a],"visible");i=g}function C(a){s(a,"Activate")}function v(){if(i==g){for(var a=0;a<b.length;++a){var c=b[a];if(c!=h)q(c,"hidden")}i=0}}function K(b){while(b){if(b==a)break;b=b.parentNode}return b}function q(b,a){b.style.visibility=a}function y(a,b){if(a)a.style.display=b}function P(f){f=l(f);d.msg();var e=r(u(f)),c=n(a,"LI");if(c){k.WeatherUp(B);if(i&&i.IsBoundTo(c)){i.Deactivate();w()}else if(i==g){v();C(c)}if(!n(c,"LI"))if(e){e.blur();e=j(b[1],"A")}j(a).insertBefore(a,c);z();s(c,"UpdateButtons");if(e)e.focus()}return p(f)}function I(h){h=l(h);d.msg();var f=r(u(h)),c=e.NextElem(a,"LI");if(c){k.WeatherDown(B);if(i&&i.IsBoundTo(c)){i.Deactivate();w()}else if(i==g){v();C(c)}if(!m(c,"LI"))if(f){f.blur();f=j(b[0],"A")}j(a).insertBefore(c,a);z();s(c,"UpdateButtons");if(f)f.focus()}return p(h)}function D(e){e=l(e);d.msg();k.DelWeatherCode(B);var b;if(!n(a,"LI"))b=m(a,"LI");else if(!m(a,"LI"))b=n(a,"LI");var f=a;O.Unbind(f,1);var c=j(f);t(c,f);if(b)s(b,"UpdateButtons");else if(x(c,"LI")==0){t(j(c),c);G()}return p(e)}function r(a){while(a&&(a.nodeType!=1||a.tagName!="A"))a=j(a);return a}function z(){y(r(b[0]),n(a,"LI")?R:F);y(r(b[1]),m(a,"LI")?R:F)}g.Deactivate=v;g.Activate=w;g.UpdateButtons=z;g.IsBoundTo=function(b){return b==a};g.dispose=function(){a=b=h=0};N();J.hook(a,"mouseover");M.hook(a,"mouseout")}function wb(){r=g(A,"FORM");if(r){var a=g(r,"INPUT");while(a){if(a.type=="text"){q=a;L=q.value}a=m(a,"INPUT")}xb.hook(r,"submit");var b=c("div");f(j(r),b);d=new Msn.HP.DA(b)}}function W(){h=g(A,"DIV",1);while(h&&!K(h,"child"))h=m(h,"DIV");var a=g(h,"UL");if(!a||x(a,"LI")==0){if(a)t(j(a),a);G()}}function s(a,d){if(a&&a.bindings)for(var b=0;b<a.bindings.length;++b){var c=a.bindings[b];if(typeof c[d]=="function")c[d]()}}function G(){f(h,c("P",lb))}function xb(b){var a=q.value;if(a&&a!=L)if(k.GetWeatherCodes().length<jb){d.msg(M,"msg",J);v=(function(a){if(a.responseXML)U(a.responseXML);else d.msg(z,"err")}).RQ(Bb.format(a),Q)}else d.msg(tb,"err");b=l(b);return p(b)}function U(h){var a=g(h,"weatherdata");if(a){var f=0;switch(x(a,"weather")){case 0:d.msg(kb,"err");break;case 1:var b=g(a,"weather"),c=b.getAttribute("searchdistance");if(!parseFloat(c)){I(b.getAttribute("weatherlocationcode"));break}default:d.msg(vb,"msg");e.ForEach(function(a){T.hook(d.add(a.getAttribute("weatherfullname"),a.getAttribute("weatherlocationcode")),"click");return ++f>=nb},a,"weather");break}}else d.msg(z,"err")}function I(a){k.AddWeatherCode(a);if(gb(a))d.msg(hb,"err");else C([a])}function w(h,f){var a,c=g(h,"H4");if(c)if(f)a=e.InnerText(c);else{var d=g(c,"A");if(d){var i=/wealocations=([^&]*)/,b=i.exec(d.href);if(b&&b.length>1)a=b[1]}}return a}function gb(c){var a=0,b=g(h,"UL");if(b)e.ForEach(function(b){if(w(b)==c)return a=1},b,"LI");return a}function T(a){a=l(a);var b=u(a);ub(b);I(b.href);return p(a)}function qb(){var a=g(h,"UL");if(a)if(x(a,"LI")>0)e.ForEach(function(a){N.bind(a,{code:w(a),name:w(a,1)})},a,"LI");else X()}function X(){var a=k.GetWeatherCodes();if(a.length>0)C(a)}function c(c,a){var b=Cb.createElement(c);if(a)b.innerHTML=a;return b}function f(a,b){return a.appendChild(b)}function t(a,b){return a.removeChild(b)}function yb(){var e=k.GetServerSetting(D),d=e=="F",b=g(A,"H2");if(b){var a=c("ul");a.className="linklist9 tog";b.insertBefore(a,b.firstChild);H(a,pb,"F","first",d);H(a,ob,"C","last",!d)}}function H(i,g,d,e,h){var a;if(h){a=c("li",g);y(a,"selected");o=a}else{a=c("li");var b=c("a",g);b.title=P[d];b.className=d;b.href="#";E.hook(b,"click");f(a,b)}if(e)y(a,e);f(i,a)}function E(d){d=l(d);var b=u(d);if(b){var g=b.className;if(g){mb(o,"selected");var h=ib[g],a=c("a",o.innerHTML);a.title=P[h];a.className=h;a.href="#";o.innerHTML="";f(o,a);E.hook(a,"click");var e=j(b,"LI");if(e){y(e,"selected");E.unhook(b,"click");e.innerHTML=b.innerHTML;o=e}k.SetServerSetting(D,g);C(k.GetWeatherCodes());return p(d)}}}function b(a,b){return typeof a!="undefined"?a:b}if(Msn.Ajax.Enabled()){wb();W();if(rb)yb();qb()}}).as("Msn.HP.Weather");(function(g,a){if(!a)a={};var q=c(a.durl,"Encarta.xml"),M=c(a.timeout,5000),E=c(a.delay,2000),J=c(a.action,"http://encarta.msn.com/encnet/features/dictionary/dictionaryresults.aspx"),H=c(a.hint,"Find a word"),B=c(a.tname,"search"),n=c(a.protocol,"enc:"),G=c(a.nav,"linklist9"),x=c(a.gtl,"linklist16"),u=c(a.imgabs,"linkedimglink1 cf"),z=c(a.max,100),y=c(a.go,"Go"),K=c(a.load,"Loading..."),o=c(a.err,"Encarta data is temporarily unavailable."),A=c(a.learn,"New on Encarta"),v=c(a.otd,"Today in History"),t=c(a.word,"Word of the Day"),D=c(a.tab,"learn"),p=this,N=document,e=Msn.DOM,h=e.ChildElem,m=Msn.HP.Settings,s=0,i,k,j,f;function d(a){return N.createElement(a)}function b(a,b){a.appendChild(b);return a}function r(){if(!s&&q){f.msg(K,"msg",E);if(i)i.cancel();i=(function(a){f.msg();if(a.responseXML)L(a.responseXML);else f.msg(o,"err")}).RQ(q,M)}}function L(j){var i=h(j,"feeds");if(i){var c=0,a;e.ForEach(function(k){var m=h(k,"feed");if(m){var i=k.nodeName;switch(i){case "learn":l(A,i,++c);break;case "otdfeed":l(v,i,++c);break;case "word":l(t,i,++c);break}a=d("div");a.className="child c"+(c+1)+" "+k.nodeName;b(g,a);var j=h(m);switch(j.nodeName){case "headlines":C(a,j);break;case "imageabstract":w(a,j);break}if(i=="word"){var f=d("form");f.action=J;f.method="get";b(a,f);Msn.Tracking.Form.bind(f);var e=d("input");e.type="text";e.maxLength=z;e.value=e.title=H;e.className="hint";e.name=B;b(f,e);Msn.HP.TextBoxHint.bind(e);e=d("input");e.type="submit";e.className="button";e.value=y;b(f,e)}}},i);if(a)e.AddClass(a,"last");s=1}else f.msg(o,"err")}function C(g,f){var a,h=0,c=d("ul");c.className=x;e.ForEach(function(f){a=d("li");if(!h++)a.className="first";var e=d("a");e.href=f.getAttribute("url");e.innerHTML=f.getAttribute("text");b(a,e);b(c,a)},f,"link");if(a&&a.className!="first")a.className="last";b(g,c)}function w(l,j){var a,g,e,f=d("span");f.className=u;b(l,f);var c=h(j,"image");if(!c)c=h(j,"img");if(c){g=c.getAttribute("url");if(g){a=d("a");a.href=g}e=d("img");e.src=c.getAttribute("src");e.width=c.getAttribute("width");e.height=c.getAttribute("height");e.alt=c.getAttribute("text");if(a){b(a,e);b(f,a)}else b(f,e)}var i=h(j,"link");if(i){var k=d("span");k.innerHTML=i.getAttribute("text");g=i.getAttribute("url");if(a&&g==a.href)b(a,k);else{a=d("a");a.href=i.getAttribute("url");b(f,a);b(a,k)}}}function I(b){b=e.Event(b);var f=e.Target(b),d=f.href.substring(n.length);e.DelClass(g,j);e.AddClass(g,d);j=d;var c=m.GetModuleData(a.code);c.D=j;m.SetModuleData(a.code,c);return e.CancelEvent(b)}function l(g,e,f){var c=d("li");if(f==1)c.className="first";if(f==3)c.className="last";var a=d("a");a.className=e;a.href=n+e;a.innerHTML=g;a.setAttribute("notrack",1);I.hook(a,"click");b(c,a);b(k,c);return c}function F(){e.AddClass(g,"quad5 cf");var h=m.GetModuleData(a.code);j=h.D?h.D:D;e.AddClass(g,j);var c=d("div");c.className="child c1 first cf";b(g,c);k=d("ul");k.className=G;b(c,k);var i=d("div");b(c,i);f=new Msn.HP.DA(i);if(!e.HasClass(g,"closed"))r()}p.OnExpand=function(){r()};p.dispose=function(){if(i)i.cancel();if(f)f.dispose();g=i=f=k=0};function c(a,b){return typeof a!="undefined"?a:b}F()}).as("Msn.HP.Encarta");(function(q,a){if(!a)a={};var qb=c(a.surl,"http://www.hotmail.msn.com/cgi-bin/mymsn/mymsn.js"),db=c(a.durl,"{0}/cgi-bin/HoTMaiL?_HMaction=delete&{1}=on&{2}"),ub=c(a.timeout,10000),G=c(a.msgs,"msgcount"),sb=c(a.scarab,"signin"),kb=c(a.stitle,"Sign In"),jb=c(a.sclass,"scarab"),eb=c(a.delay,2000),nb=c(a.load,"Loading..."),R=c(a.empty,"You have no new messages in your inbox."),t=c(a.err,"The Hotmail service is temporarily unavailable."),fb=c(a.noacct,"This module requires an activated Hotmail account. Click here to sign in."),ib=c(a.inact,"Your Hotmail account is inactive. Click here to sign in and reactivate."),lb=c(a.block,"This Hotmail account has been closed. Access is denied."),J=c(a.today,"Today"),E=c(a.yester,"Yesterday"),F=c(a.date,"ddd MMM d"),H=c(a.time,"h:mm tt"),bb=c(a.cntdef,"Check your mail"),mb=c(a.cnt0,"No new messages."),ob=c(a.cnt1,"1 new message!"),U=c(a.cnt2,"{0} new messages!"),W=c(a.nav,"linklist9"),V=c(a.more,"More..."),K=[{text:"Compose",cmd:"compose",piiurl:"http://www.hotmail.msn.com/pii/Top_Compose/"},{text:"Inbox",cmd:"hotmail",piiurl:"http://www.hotmail.msn.com/pii/Top_Inbox/"},{text:"Calendar",url:"http://calendar.msn.com/calendar/isapi.dll"},{text:"Contacts",cmd:"addresses",piiurl:"http://www.hotmail.msn.com/pii/Top_Contacts/"}],Q=c(a.defhref,"http://www.hotmail.msn.com/cgi-bin/sbox?rru=hotmail"),N=c(a.cntpiiurl,"http://www.hotmail.msn.com/pii/GreetingBar_Inbox/"),M=c(a.cntpiitxt,"New Messages"),P=c(a.msgpiiurl,"http://www.hotmail.msn.com/pii/Email_Read/"),O=c(a.msgpiitxt,"Read Email"),A="Delete",cb='<a href="{1}">{0}<span title="{2}" class="{3}"></span></a>',j=typeof a.del!="undefined"?a.del:A;if(typeof j!="string")j=j?A:0;var p=a.auth?a.auth:0;if(p&&typeof p=="string")p=p.toLowerCase()=="true";var y=this,z=document,b=window,h=Msn.DOM,n=h.HasClass,e=h.AddClass,r=h.Updated,g,k,o,l,x,I=0,C="hotmail";function f(a){return z.createElement(a)}function d(a,b){a.appendChild(b);return a}function m(b,a,c){b.setAttribute(a,c)}function D(a){return z.getElementById(a)}y.dispose=function(){if(g)g.dispose();q=o=l=g=0};y.OnExpand=function(){if(!I)if(p)rb();else{b.iError=2;i()}};function gb(){L();s();if(b.bIsNewMail)j=0;if(b.aInboxView.length==0)g.msg(R,"msg");else{g.msg();var k=b.aInboxView.length<b.iInboxTotal,h,a,i=f("ul");e(i,"linklist1");d(l,i);for(var c=0;c<b.aInboxView.length;++c){var m=b.aInboxView[c];a=f("li");e(a,!c?"first":!k&&c==b.aInboxView.legnth-1?"last":"");d(i,a);if(j)X.bind(a,m);S(a,m)}if(k){a=f("li");e(a,"last");h=f("a");h.href=w(C);e(h,"morelink");h.innerHTML=V;d(a,h);d(i,a)}}}function X(c,m){var a,g=0;this.dispose=function(){c=a=0};function o(){var b=f("a");e(b,"del");b.setAttribute("notrack",1);b.title=j;d(c,b);b.href=p(m.strMsgLink);t.hook(b,"click");q.hook(b,"focus");r.hook(b,"blur");a=f("div");d(b,a)}function q(){g=1;k()}function r(){g=0;i()}function t(j){var f=new Image;f.onload=f.onerror=function(){f.onload=f.onerror=null};f.src=h.ParentElem(a,"A").href;if(m.oIcon.bRead){--b.iNewInbox;s()}--b.iInboxTotal;var d=c;if(n(d,"first")){var g=h.NextElem(d,"LI");if(g){e(g,"first");if(n(g,"last"))h.DelClass(g,"last")}}else if(n(d,"last")){var i=h.PrevElem(d,"LI");if(i&&!n(i,"first"))e(i,"last")}Msn.Bind.Unbind(d,1);h.ParentElem(d).removeChild(d);j=h.Event(j);return h.CancelEvent(j)}function p(e){var f="#",d=e.match(/http:\/\/([^\/?\s])*/i);if(d&&d[0]){var c=e.match(/\brru=([^&]*)/i);if(c&&c.length>1&&c[1]){var a=unescape(c[1]).match(/\bmsg=([^&]*)/i);if(a&&a.length>1&&a[1])f=db.format(d[0],a[1],b.strA)}}return f}function k(){l("visible")}function i(){if(!g)l("hidden")}function l(b){a.style.visibility=b}o();k.hook(c,"mouseover");i.hook(c,"mouseout")}function S(h,c){var a=f("a");a.href=c.strMsgLink+"&"+b.strA;e(a,"msg "+ab(c));if(c.oIcon.bRead)e(a,"unread");m(a,"piitxt",O);m(a,"piiurl",P);d(h,a);var g=f("div");e(g,"pri "+T(c));d(a,g);d(g,u("sent",Z(c.dDate)));d(g,u("from",c.strFromName));d(g,u("subj",c.strSubject));return a}function Z(b){var a,e=86400000,g=new Date,f=g.getDay(),d=b.getDay(),c=g.getTime()-b.getTime();if(J&&c<e&&f==d)a=J;else if(E&&c<2*e&&f==(d+1)%7)a=E;if(F&&!a)a=b.format(F);if(H)a+=(a?"<br/>":"")+b.format(H);return a}function u(b,c){var a=f("div");e(a,b);a.innerHTML=c;return a}function ab(d){var a=d.oIcon,c=a.iReply,b=a.iGroup;if(c==1)return "replied";if(c==2)return "forwarded";if(b==3)return "msn";if(b==4)return "courier";if(a.bAttach)return "attach";if(a.bRead)return "unread";return "read"}function T(a){switch(a.oIcon.iPriority){case 1:return "low";case 2:return "high";default:return "norm"}}function rb(){g.msg(nb,"msg",eb);I=1;var e=qb+"?nocache="+Math.random(),c=z.getElementsByTagName("head")[0],a=f("script");a.type="text/javascript";a.onload=i;a.onerror=Y;a.onreadystatechange=function(){if(a.readyState=="loaded"){a.onreadystatechange=null;d(c,a);i()}};a.src=e;k=b.setTimeout(tb,ub);if(typeof a.readyState=="undefined"){d(c,a);if(typeof b.iError!="undefined")i()}}function i(){if(typeof b.iError=="number"&&b.iError){v();switch(b.iError){case 1:case 2:g.msg(B(fb),"msg");break;case 3:g.msg(B(ib),"msg");break;case 4:g.msg(lb,"err");break;default:g.msg(t,"err");break}r()}else if(typeof b.aInboxView=="object")if(!b.aInboxView){v();g.msg(t,"err");r()}else if(typeof b.AmIDone=="number"&&b.AmIDone){v();gb();r()}}function Y(){b.iError=99;i()}function tb(){if(k){k=0;if(typeof b.AmIDone=="number"&&b.AmIDone==1)i();else{g.msg(t,"err");r()}}}function B(a){if(x)a=cb.format(a,x,kb,jb);return a}function v(){if(k){b.clearTimeout(k);k=0}g.msg()}function w(a){return b.strBaseURL+b.strA+"&rru="+a}function L(){var b,g=f("ul");e(g,W);for(var c=0;c<K.length;++c){var a=K[c];b=pb(g,a.text,a.cmd?w(a.cmd):a.url,a.piiurl);if(!c)e(b,"first")}if(b)e(b,"last");d(o,g)}function pb(h,g,e,c){var b=f("li"),a=f("a");a.href=e;a.innerHTML=g;if(c)m(a,"piiurl",c);d(b,a);d(h,b);return b}function s(){if(G){var c=D(G);if(c){c.innerHTML="";var a=f("a");d(c,a);if(typeof b.iError!="number"||b.iError||typeof b.iNewInbox!="number"){a.innerHTML=bb;a.href=Q}else{switch(b.iNewInbox){case 0:a.innerHTML=mb;break;case 1:a.innerHTML=ob;e(a,"new");break;default:a.innerHTML=U.format(b.iNewInbox);e(a,"new");break}a.href=w(C)}m(a,"piiurl",N);m(a,"piitxt",M)}}}function hb(){e(q,"double2 cf");o=f("div");e(o,"child c1 first");d(q,o);l=f("div");e(l,"child c2 last");d(q,l);var b=f("div");d(l,b);g=new Msn.HP.DA(b,{close:0});var a=D(sb);if(a){if(!a.href)a=h.ChildElem(a,"A");if(a)x=a.href}s();if(!n(q,"closed"))y.OnExpand()}function c(a,b){return typeof a!="undefined"?a:b}hb()}).as("Msn.HP.Hotmail");(function(h,a){if(!a)a={};var x=c(a.show,8000),J=c(a.fade,0),y=c(a.gap,1000),q=c(a.prev,"< Previous"),p=c(a.next,"Next >"),C=c(a.flip,"nav"),u=c(a.man,0),w=c(a.ss,"block"),g=Msn.DOM,A=document,i=window,f=0,d=0,b=0,l=1,k=[],j=E();if(j>1){F(h);D()}function r(a){return A.createElement(a)}function m(a,b){a.appendChild(b)}function E(){for(var b=0;b<h.childNodes.length;++b){var a=h.childNodes[b];if(a.nodeType==1){k.push(a);if(a.currentStyle&&a.currentStyle.display=="block")w="block"}}return k.length}function D(){if(q||p){var a=r("div");a.className=C;m(g.ParentElem(h),a);if(q)H.hook(v(a,q,"prev"),"click");if(p)G.hook(v(a,p,"next"),"click")}}function H(a){t(j-1);a=g.Event(a);return g.CancelEvent(a)}function G(a){t(1);a=g.Event(a);return g.CancelEvent(a)}function t(a){n();d=(d+a)%j;o();e()}function s(a){k[d].style.display=a}function o(){s(w)}function n(){s("none")}function v(c,d,b){var a=r("a");a.href="#";a.className=b;m(a,A.createTextNode(d));a.setAttribute("notrack",1);m(c,a);return a}function F(a){if(!u){e.hook(a,"mousemove");if(J)a.style.filter=("progid:DXImageTransform.Microsoft.Fade(duration={0})").format(y/2000);var c=a.filters;b=c&&c.length>0?c[0]:0;if(b)(function(){if(l)i.setTimeout(z,1);else e();l=!l}).hook(a,"filterchange");else x+=y/2;a=0;e()}}function e(){if(f)i.clearTimeout(f);f=u?0:i.setTimeout(I,x)}function I(){if(b){b.apply();n();b.play()}else n();d=(d+1)%j;if(!b)z()}function z(){if(b){b.apply();o();b.play()}else{o();e()}}function B(){if(f)i.clearTimeout(f)}B.hook(i,"unload");this.dispose=function(){h=null;k=0};function c(a,b){return typeof a!="undefined"?a:b}}).as("Msn.HP.Slideshow");(function(c,a){if(!a)a={};var S=b(a.txt,"Make this your homepage"),q=b(a.tc,"ie7promo"),J=b(a.spurl,"ajax/searchpromo.aspx"),y=b(a.tced,30),B=b(a.tsps,"Search Prompt shown"),L=b(a.tsp,"Set Provider"),F=b(a.tdss,"Don't Show Search"),z=b(a.thps,"Homepage Prompt shown"),K=b(a.tshp,"Set HomePage"),C=b(a.tdsh,"Don't Show Homepage"),H=b(a.dhppurl,"ajax/DHPpromo.aspx"),E=b(a.shpt,1),l=a.url?a.url:window.location.href,d=Msn.DOM,k=d.ChildElem,v=Msn.HP.Settings,f=Msn.Tracking,x=document,e,h,m,s=1,t=2,i=false,n;c.style.behavior="url(#default#homepage)";if(A()){var p=v.GetCookie(q);n=p?p:0;if(!(p&s)){n|=s;r.RQ(J)}else if(E&&(typeof c.isHomePage!="undefined"&&!c.isHomePage(l))&&!(p&t)){i=true;n|=t;r.RQ(H)}}P();function b(a,b){return typeof a!="undefined"?a:b}this.dispose=function(){c=h=e=0};function A(){if(q){var a=navigator.userAgent,b=a.indexOf("MSIE"),c=a.indexOf("MSN");if(c<0&&b>0&&parseInt(a.substring(b+4))>=7)return true}return false}function P(){if(typeof c.isHomePage!="undefined"&&!c.isHomePage(l)){w("none");h=g("a");h.href=l;h.innerHTML=S;O.hook(h,"click");j(c,h)}}function r(d){var a=1,c=d.responseXML;if(c){var b=k(c,"channel");if(b)a=R(b)}return a}function R(d){var k=o(d,"title",1),p=o(d,"description",1),h=N("wrapper");if(h){e=g("div");e.id="tickler";e.style.filter="progid:DXImageTransform.Microsoft.gradient(startColor=0, endColorStr=#ffffff)";h.insertBefore(e,h.firstChild);var b=g("a");b.className="del";b.href="#";j(e,b);var l=g("div");j(b,l);l.style.visibility="visible";b.title="Close";G.hook(b,"click");var a=g("form");a.action="#";a.method="GET";j(e,a);M.hook(a,"submit");if(i)k=k.format(Q(d));else{e.className="search";D(d)}var m=g("label",k);j(a,m);var c=g("input");c.type="submit";c.className="button";c.value=p;j(a,c);v.SetCookie(q,n,y);if(f)if(i)f.Event(a,"",z);else f.Event(a,"",B);b=m=a=c=0}return 0}function Q(e){var a=k(e,"item",1);if(a){var c,b,d;c=k(a,"enclosure",1);b=c.getAttribute("url");if(b){d=o(a,"title",1);return ('<img src="{0}" alt="{1}" />').format(b,d)}}return "MSN"}function D(b){var c=k(b,"item",1),a=o(c,"link",1);if(a&&!m)m=a}function G(a){if(f)if(i)f.Event(d.Target(a),"",C);else f.Event(d.Target(a),"",F);a=d.Event(a);e.style.display="none";return d.CancelEvent(a)}function M(a){a=d.Event(a);var b=d.Target(a);if(f)if(i)f.Event(b,"",K);else f.Event(b,"",L);try{if(i)u();else I()}catch(c){}e.style.display="none";return d.CancelEvent(a)}function I(){if(m&&window.external&&typeof window.external.AddSearchProvider!="undefined")window.external.AddSearchProvider(m)}function u(){c.setHomePage(l);if(c.isHomePage(l)){c.removeChild(h);w()}}function O(a){u();a=d.Event(a);return d.CancelEvent(a)}function w(d){for(var b=0;b<c.childNodes.length;++b){var a=c.childNodes[b];if(a.nodeType==1)if(d){a.prevDisplay=a.style.display;a.style.display=d}else a.style.display=a.prevDisplay}}function g(c,b){var a=x.createElement(c);if(b)a.innerHTML=b;return a}function o(b,c,e){var a=k(b,c,e);return a?d.InnerText(a):""}function j(a,b){a.appendChild(b)}function N(a){return x.getElementById(a)}}).as("Msn.HP.MakeMSN");(function(d,a){if(!a)a={};var b=f(a.txt,"Restore defaults"),i=document,c=Msn.DOM,g=Msn.HP.Settings;if(b)h();function h(){var a=i.createElement("a");a.href="#";a.innerHTML=b;e.hook(a,"click");d.appendChild(a)}function e(a){a=c.Event(a);g.ClearCookies();window.location.reload(true);return c.CancelEvent(a)}this.dispose=function(){d=null};function f(a,b){return typeof a!="undefined"?a:b}}).as("Msn.HP.Restore");(function(a,d){var c=Msn.DOM,e=window,b=Msn.Tracking;this.dispose=function(){a=0};(function(f){f=c.Event(f);var g=typeof d=="string"?d:a.rel?a.rel:"";if(c.HasClass(a,"popup")){e.open(a.href,"",g);if(b)b.Event(a);return c.CancelEvent(f)}else if(e.open(a.href,"",g)){if(b)b.Event(a);return c.CancelEvent(f)}}).hook(a,"click")}).as("Msn.HP.OpenNew")